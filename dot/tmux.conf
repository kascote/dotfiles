unbind C-b
set -g prefix C-Space

# change command delay
set -s escape-time 0
# set vim keybiding on command prompt
set -g status-keys vi
set -g default-terminal "xterm-256color"
set -ga terminal-overrides ",xterm-256color:Tc"
set -g history-limit 262144

## set window notifications
set -g visual-activity on
#set -g visual-content on
# set clock to 24h format
setw -g clock-mode-style 24
# use vim motion keys while in copy mode
setw -g mode-keys vi
# Set window notifications
setw -g monitor-activity off

## tmux window titling for X
set -g set-titles on
set -g set-titles-string '[#I] #S > #W'
# rename windows to current command
setw -g automatic-rename off
setw -g window-status-format ' #I #W '
setw -g window-status-attr bold
# Show bells in window titles.
set -g window-status-bell-style fg=yellow,bold,underscore
# focus events enabled for terminals that support them
set -g focus-events on
# super useful when using "grouped sessions" and multi-monitor setup
setw -g aggressive-resize on

## starts windows at 1 not 0
set -g base-index 1
setw -g pane-base-index 1
# renumber windows sequentially after closing any of them
set -g renumber-windows on

# enable mouse
set -g mouse on

# Don't wrap searches; it's super confusing given tmux's reverse-ordering of
# position info in copy mode.
set -w -g wrap-search off

#------------ THEME

# Highlight active window
setw -g window-status-current-bg '#eeeeee'
setw -g window-status-current-fg '#444444'

setw -g window-status-bg '#333333'
setw -g window-status-fg '#999999'

## pane border and colors
set -g pane-active-border-fg colour240
set -g pane-border-fg colour240

# Status bar
set -g status-bg '#333333'
set -g status-fg '#ffffff'
set -g status-left-length 70
set -g status-left-bg '#777777'
set -g status-left-fg '#222222'
set -g status-left ' #H:#S '
set -g status-right ''
# refresh 'status-left' and 'status-right' more often
set -g status-interval 5
set -g status-keys vi

set -g message-bg red
set -g message-fg yellow

set -g mode-bg '#ff00ff'
set -g mode-fg '#000000'

# messages
set-option -g message-fg colour229
set-option -g message-bg "#111111"
set-option -g display-time 4000

# Automatically renumber window numbers on closing a pane (tmux >= 1.7).
set -g renumber-windows on


# ---- BINDINGS ----

# Open new/split panes with the path of the current pane.
unbind c
bind c new-window -c '#{pane_current_path}'
unbind %
bind % split-window -h -c '#{pane_current_path}'
unbind '"'
bind '"' split-window -v -c '#{pane_current_path}'

# use "v" and "s" to do vertical/horizontal splits, like vim
bind s split-window -v
bind v split-window -h

# use the vim motion keys to move between panes
bind h select-pane -L
bind j select-pane -D
bind k select-pane -U
bind l select-pane -R

# alternaly last 2 layouts
bind p select-layout -o

# move between windows
bind -r C-h select-window -t :-
bind -r C-l select-window -t :+

# use the vim resize keys.
# the number at the end is how much the pane will be resized,
# and 1 is fairly small -- you might want to tweak this.
unbind Left
bind -r Left resize-pane -L 5
unbind Right
bind -r Right resize-pane -R 5
unbind Down
bind -r Down resize-pane -D 5
unbind Up
bind -r Up resize-pane -U 5

# Fast toggle (normally prefix-l).
bind ^space last-window


# force a reload of the config file
bind R source-file ~/.tmux.conf \; display-message "Config reloaded..."

# vimify the buffer keys
unbind [
bind Escape copy-mode
unbind p
bind p paste-buffer

# Stay in copy mode on drag end.
# (Would use `bind-key -T copy-mode-vi MouseDragEnd1Pane send-keys -X
# stop-selection` but it is a bit glitchy.)
unbind-key -T copy-mode-vi MouseDragEnd1Pane

# Scroll 3 lines at a time instead of default 5; don't extend dragged selections.
bind-key -T copy-mode-vi WheelUpPane select-pane\; send-keys -t{mouse} -X clear-selection\; send-keys -t{mouse} -X -N 3 scroll-up
bind-key -T copy-mode-vi WheelDownPane select-pane\; send-keys -t{mouse} -X clear-selection\; send-keys -t{mouse} -X -N 3 scroll-down

# Make double and triple click work outside of copy mode (already works inside it with default bindings).
bind-key -T root DoubleClick1Pane if-shell -Ft{mouse} '#{alternate_on}' "send-keys -M" "copy-mode -t{mouse}; send-keys -t{mouse} -X select-word"
bind-key -T root TripleClick1Pane if-shell -Ft{mouse} '#{alternate_on}' "send-keys -M" "copy-mode -t{mouse}; send-keys -t{mouse} -X select-line"

# For those times when C-c and q are not enough.
bind-key -T copy-mode-vi Escape send-keys -X cancel

# bind -t vi-copy 'v' begin-selection
# unbind -t vi-copy Enter
# bind -t vi-copy Enter copy-pipe "nc localhost 8377"

bind-key y run-shell "tmux save-buffer - | nc -U ~/.clipper.sock"
# "copy-pipe" requires tmux >= 1.8
bind-key -T copy-mode-vi Enter send-keys -X copy-pipe-and-cancel "nc -U ~/.cache/clipper/clipper.sock"


# extra commands for interacting with the ICCCM clipboard
#bind C-c run "tmux save-buffer - | xclip -i -sel clipboard"
#bind C-v run "tmux set-buffer \"$(xclip -o -sel clipboard)\"; tmux paste-buffer"

# move between sessions
bind -r z switch-client -p
bind -r x switch-client -n

# Slightly more useful width in "main-vertical" layout; enough room for 3-digit
# line number gutter in Vim + 80 columns of text + 1 column breathing room
# (default looks to be about 79).
set -w -g main-pane-width 85


# bind -T root WheelUpPane   if-shell -F -t = "#{alternate_on}" "send-keys -M" "select-pane -t =; copy-mode -e; send-keys -M"
# bind -T root WheelDownPane if-shell -F -t = "#{alternate_on}" "send-keys -M" "select-pane -t =; send-keys -M"


